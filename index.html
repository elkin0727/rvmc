<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Programa de Reunión Final</title>
    <link rel="stylesheet" href="styles.css"> 
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">

    
</head>
<body>

    <div class="programa-container">
        <header class="programa-header">
            <h1>26 DE MAYO A 1 DE JUNIO | PROVERBIOS 15</h1>            <div class="oficiales">
                <div class="fila-superior">
                    <p><strong>Presidente:</strong> David Ramirez</p>
                    <p><strong>Oración:</strong> Elkin Siabato</p>
                </div>
                <p><strong>Consejero de la sala auxiliar:</strong> Jorge Espitia</p>
            </div>
        </header>

        <main>
            <!-- Grid Inicial -->
            <div class="programa-grid grid-inicial">
                <div class="fila-programa">
                    <span class="hora">6:30</span>
                    <p class="descripcion">● Canción 102</p>
                    <div class="participantes-columna"></div>
                </div>
                <div class="fila-programa">
                    <span class="hora">6:35</span>
                    <p class="descripcion">Palabras de introducción (1 min.)</p>
                    <div class="participantes-columna"><span class="participante-unico">Hugo Posada</span></div>
                </div>

                <div class="titulo-seccion seccion-tesoros"><h2>TESOROS DE LA BIBLIA</h2></div>
                <div class="fila-programa">
                    <span class="hora">6:36</span>
                    <p class="descripcion">1. Ayude a los demás a tener un corazón alegre (10 mins.)</p>
                    <div class="participantes-columna"><span class="participante-unico">Alex Vivas</span></div>
                </div>
                <div class="fila-programa">
                    <span class="hora">6:46</span>
                    <p class="descripcion">2. Busquemos perlas escondidas (10 mins.)</p>
                    <div class="participantes-columna"><span class="participante-unico">Ricardo Sierra</span></div>
                </div>
            </div>

            <!-- Grid Maestros -->
            <div class="programa-grid grid-maestros">
                <div class="fila-header-salas">
                    <span></span> <span></span> <div class="participantes-columna">
                        <div class="division-salas">
                            <div class="sala-header">Sala Auxiliar</div>
                            <div class="sala-header">Auditorio Principal</div>
                        </div>
                    </div>
                </div>

                <div class="fila-programa con-division">
                    <span class="hora">6:56</span>
                    <p class="descripcion">3. Lectura de la Biblia (4 mins.)</p>
                    <div class="participantes-columna">
                        <div class="division-salas">
                            <div class="sala"><span class="participante">Daniel Cruz</span></div>
                            <div class="sala"><span class="participante">Diego Moreno</span></div>
                        </div>
                    </div>
                </div>

                <div class="titulo-seccion seccion-maestros"><h2>SEAMOS MEJORES MAESTROS</h2></div>
                <div class="fila-programa con-division">
                    <span class="hora">7:01</span>
                    <p class="descripcion">4. Empiece conversaciones (3 mins.)</p>
                    <div class="participantes-columna">
                        <div class="division-salas">
                            <div class="sala"><span class="participante">Liliana Cruz/ Paola Romero</span></div>
                            <div class="sala"><span class="participante">Nelkari Garcia/ Lilia Hernandez</span></div>
                        </div>
                    </div>
                </div>
                <div class="fila-programa con-division">
                    <span class="hora">7:06</span>
                    <p class="descripcion">5. Empiece conversaciones (4 mins.)</p>
                    <div class="participantes-columna">
                        <div class="division-salas">
                            <div class="sala"><span class="participante">Ambar Diaz/ Elizabeth Vivas</span></div>
                            <div class="sala"><span class="participante">Diego Guzman/ Juan Manuel Toro</span></div>
                        </div>
                    </div>
                </div>
                <div class="fila-programa con-division">
                    <span class="hora">7:11</span>
                    <p class="descripcion">6. Haga discípulos (5 mins.)</p>
                    <div class="participantes-columna">
                        <div class="division-salas">
                            <div class="sala"><span class="participante">Yeimy Sierra/ Nanadorith Hernandez</span></div>
                            <div class="sala"><span class="participante">Sebastian Garcia/ Felipe Espitia</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Grid Vida Cristiana -->
            <div class="programa-grid grid-vida-cristiana">
                <div class="titulo-seccion seccion-vida-cristiana"><h2>NUESTRA VIDA CRISTIANA</h2></div>
                <div class="fila-programa">
                    <span class="hora">7:16</span>
                    <p class="descripcion">● Canción 155</p>
                    <div class="participantes-columna"></div>
                </div>
                <div class="fila-programa">
                    <span class="hora">7:21</span>
                    <p class="descripcion">7. Podemos tener un corazón alegre a pesar de las pruebas (15 mins.)</p>
                    <div class="participantes-columna"><span class="participante-unico">Martin García</span></div>
                </div>
            </div>

            <!-- Fila estudio bíblico de la congregación con grid propio -->
            <div class="programa-grid grid-estudio-biblico">
                <div class="fila-programa">
                    <span class="hora">7:36</span>
                    <p class="descripcion">8. Estudio bíblico de la congregación (30 mins.)</p>
                    <div class="participantes-columna">
                        <span class="participante-unico"><strong>Conductor:</strong> Joaquin Cruz / <strong>Lector:</strong> José Antonio Romero</span>
                    </div>
                </div>
            </div>

            <div class="programa-grid grid-vida-cristiana">
                <div class="fila-programa">
                    <span class="hora">8:06</span>
                    <p class="descripcion">● Palabras de conclusión (3 min.)</p>
                    <div class="participantes-columna"></div>
                </div>                <div class="fila-programa final-combinada">
                    <span class="hora">8:09</span>
                    <p class="descripcion">● Canción 100</p>
                    <div class="participantes-columna">
                        <span class="participante-unico final"><strong>Oración final:</strong> Camilo Pulido</span>
                    </div>
                </div>
            </div>
            </div>
        </main>
    </div>
    <div id="programa">
        <!-- El contenido del programa se generará dinámicamente -->
    </div>
    
    <button onclick="generarYCopiarEnlace()" class="boton-enlace">Generar Enlace</button>

    <script>
        // Función para generar y copiar el enlace
        function generarYCopiarEnlace() {
            const enlace = generarEnlace(mockData);
            navigator.clipboard.writeText(enlace).then(() => {
                alert('Enlace copiado al portapapeles');
            }).catch(err => {
                console.error('Error al copiar el enlace:', err);
                alert('Error al copiar el enlace. Por favor, inténtalo de nuevo.');
            });
        }

        // Función para generar enlace con los datos
        function generarEnlace(datos) {
            const baseUrl = window.location.href.split('?')[0]; // Obtiene la URL base sin parámetros
            const encodedData = encodeURIComponent(JSON.stringify(datos));
            return `${baseUrl}?data=${encodedData}`;
        }

        // Mock data por defecto
        const mockData = {
            "fecha": "26 DE MAYO A 1 DE JUNIO",
            "tema": "PROVERBIOS 15",
            "presidente": "David Ramirez",
            "oracionInicial": "Elkin Siabato",
            "consejero": "Jorge Espitia",
            "tesoros": [
                {
                    "hora": "6:30",
                    "titulo": "● Canción 122",
                    "duracion": "",
                    "asignado": []
                },
                {
                    "hora": "6:35",
                    "titulo": "Palabras de introducción",
                    "duracion": "1 min.",
                    "asignado": ["Hugo Posada"]
                },
                {
                    "hora": "6:36",
                    "titulo": "1. Ayude a los demás a tener un corazón alegre",
                    "duracion": "10 mins.",
                    "asignado": ["Alex Vivas"]
                },
                {
                    "hora": "6:46",
                    "titulo": "2. Busquemos perlas escondidas",
                    "duracion": "10 mins.",
                    "asignado": ["Ricardo Sierra"]
                },
                {
                    "hora": "6:56",
                    "titulo": "3. Lectura de la Biblia",
                    "duracion": "4 mins.",
                    "asignadoSalaA": ["Daniel Cruz"],
                    "asignadoSalaB": ["Diego Moreno"]
                }
            ],
            "maestros": [
                {
                    "hora": "7:01",
                    "titulo": "4. Empiece conversaciones",
                    "duracion": "3 mins.",
                    "asignadoSalaA": ["Liliana Cruz", "Paola Romero"],
                    "asignadoSalaB": ["Nelkari Garcia", "Lilia Hernandez"]
                },
                {
                    "hora": "7:06",
                    "titulo": "5. Empiece conversaciones",
                    "duracion": "4 mins.",
                    "asignadoSalaA": ["Ambar Diaz", "Elizabeth Vivas"],
                    "asignadoSalaB": ["Diego Guzman", "Juan Manuel Toro"]
                },
                {
                    "hora": "7:11",
                    "titulo": "6. Haga discípulos",
                    "duracion": "5 mins.",
                    "asignadoSalaA": ["Yeimy Sierra", "Nanadorith Hernandez"],
                    "asignadoSalaB": ["Sebastian Garcia", "Felipe Espitia"]
                }
            ],
            "vidaCristiana": [
                {
                    "hora": "7:16",
                    "titulo": "● Canción 155",
                    "duracion": "",
                    "asignado": []
                },
                {
                    "hora": "7:21",
                    "titulo": "7. Podemos tener un corazón alegre a pesar de las pruebas",
                    "duracion": "15 mins.",
                    "asignado": ["Martin García"]
                }
            ],
            "estudioBiblico": {
                "hora": "7:36",
                "titulo": "8. Estudio bíblico de la congregación",
                "duracion": "30 mins.",
                "asignado": ["Conductor: Joaquin Cruz", "Lector: José Antonio Romero"]
            },
            "oracionFinal": {
                "hora": "8:09",
                "titulo": "● Canción 100",
                "duracion": "",
                "asignado": ["Oración: Camilo Pulido"]
            }
        };

        // Función para obtener datos de la URL o usar mockData
        function obtenerDatos() {
            const params = new URLSearchParams(window.location.search);
            const dataParam = params.get('data');
            if (dataParam) {
                try {
                    return JSON.parse(decodeURIComponent(dataParam));
                } catch (e) {
                    console.error('Error al parsear datos de URL:', e);
                    return mockData;
                }
            }
            return mockData;
        }

        // Función para unir nombres con " / "
        const unirNombres = nombres => nombres.join(' / ');

        // Función para crear una fila del programa
        function crearFilaPrograma(hora, titulo, duracion = '', asignado = []) {
            const descripcion = duracion ? `${titulo} (${duracion})` : titulo;
            return `
                <div class="fila-programa">
                    <span class="hora">${hora}</span>
                    <p class="descripcion">${descripcion}</p>
                    <div class="participantes-columna">
                        ${asignado.length ? `<span class="participante-unico">${unirNombres(asignado)}</span>` : ''}
                    </div>
                </div>
            `;
        }

        // Función para crear una fila con dos salas
        function crearFilaDosSalas(hora, titulo, duracion, salaA, salaB) {
            return `
                <div class="fila-programa con-division">
                    <span class="hora">${hora}</span>
                    <p class="descripcion">${titulo} (${duracion})</p>
                    <div class="participantes-columna">
                        <div class="division-salas">
                            <div class="sala"><span class="participante">${unirNombres(salaA)}</span></div>
                            <div class="sala"><span class="participante">${unirNombres(salaB)}</span></div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Función para renderizar el programa
        function renderizarPrograma(data) {
            // Actualizar encabezado
            document.querySelector('.programa-header h1').textContent = `${data.fecha} | ${data.tema}`;
            
            // Actualizar oficiales
            document.querySelector('.oficiales').innerHTML = `
                <div class="fila-superior">
                    <p><strong>Presidente:</strong> ${data.presidente}</p>
                    <p><strong>Oración:</strong> ${data.oracionInicial}</p>
                </div>
                <p><strong>Consejero de la sala auxiliar:</strong> ${data.consejero}</p>
            `;            // Renderizar sección Tesoros
            let gridInicial = document.querySelector('.grid-inicial');
            let content = '';
            
            // Primero renderizar canción y palabras de introducción
            const itemsIniciales = data.tesoros.slice(0, 2);
            itemsIniciales.forEach(item => {
                content += crearFilaPrograma(item.hora, item.titulo, item.duracion, item.asignado);
            });

            // Agregar título de la sección
            content += '<div class="titulo-seccion seccion-tesoros"><h2>TESOROS DE LA BIBLIA</h2></div>';
            
            // Renderizar resto de items de Tesoros
            data.tesoros.slice(2).forEach(item => {
                if (item.asignadoSalaA && item.asignadoSalaB) {
                    // Si es una fila con dos salas, moverla a la sección de maestros
                    const gridMaestros = document.querySelector('.grid-maestros');
                    if (item.titulo.includes('Lectura de la Biblia')) {
                        gridMaestros.innerHTML = `
                            <div class="fila-header-salas">
                                <span></span>
                                <span></span>
                                <div class="participantes-columna">
                                    <div class="division-salas">
                                        <div class="sala-header">Sala Auxiliar</div>
                                        <div class="sala-header">Auditorio Principal</div>
                                    </div>
                                </div>
                            </div>
                            ${crearFilaDosSalas(item.hora, item.titulo, item.duracion, item.asignadoSalaA, item.asignadoSalaB)}
                            <div class="titulo-seccion seccion-maestros"><h2>SEAMOS MEJORES MAESTROS</h2></div>
                        `;
                    }
                } else {
                    content += crearFilaPrograma(item.hora, item.titulo, item.duracion, item.asignado);
                }
            });
            gridInicial.innerHTML = content;

            // Renderizar sección Maestros
            const gridMaestros = document.querySelector('.grid-maestros');
            data.maestros.forEach(item => {
                gridMaestros.insertAdjacentHTML('beforeend',
                    crearFilaDosSalas(item.hora, item.titulo, item.duracion, item.asignadoSalaA, item.asignadoSalaB)
                );
            });

            // Renderizar Vida Cristiana
            let gridVidaCristiana = document.querySelector('.grid-vida-cristiana');
            content = '<div class="titulo-seccion seccion-vida-cristiana"><h2>NUESTRA VIDA CRISTIANA</h2></div>';
            data.vidaCristiana.forEach(item => {
                content += crearFilaPrograma(item.hora, item.titulo, item.duracion, item.asignado);
            });
            gridVidaCristiana.innerHTML = content;

            // Renderizar Estudio Bíblico
            const gridEstudioBiblico = document.querySelector('.grid-estudio-biblico');
            const eb = data.estudioBiblico;
            gridEstudioBiblico.innerHTML = crearFilaPrograma(eb.hora, eb.titulo, eb.duracion, eb.asignado);

            // Renderizar sección final
            const ultimaSeccion = document.querySelector('.grid-vida-cristiana:last-child');
            ultimaSeccion.innerHTML = `
                <div class="fila-programa">
                    <span class="hora">8:06</span>
                    <p class="descripcion">● Palabras de conclusión (3 min.)</p>
                    <div class="participantes-columna"></div>
                </div>
                <div class="fila-programa final-combinada">
                    <span class="hora">${data.oracionFinal.hora}</span>
                    <p class="descripcion">${data.oracionFinal.titulo}</p>
                    <div class="participantes-columna">
                        <span class="participante-unico final"><strong>Oración final:</strong> ${data.oracionFinal.asignado[0].replace('Oración:', '')}</span>
                    </div>
                </div>
            `;
        }

        // Inicializar cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', () => {
            const datos = obtenerDatos();
            renderizarPrograma(datos);
        });
    </script>
</body>
</html>